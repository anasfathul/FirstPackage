---
title: "Project 3: FirstPackage Tutorial"
author: "Muhammad Anas"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{FirstPackage Tutorial}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```


### Introduction
- This package consist of 4 statistical function that developed through the course STAT 302 in University of Washington. The package can be install by the following line of code:
```{r setup}
library(magrittr)
library(dplyr)
library(tidyverse)
library(kableExtra)
library(ggplot2)
library(class)
library(randomForest)
```

```{r, eval = FALSE}
devtools::install_github("anasmuhd/FirstPackage", build_vignette = TRUE, build_opts = c())
```
```{r}
library(FirstPackage)
```
### my_t.test
- my_t.test function will evaluate all hypothesis (less, greater, two side) of the data $lifeExp$ from $my\_gapminder$

$$H_0: \mu = 60$$
$$H_a: \mu \neq 60$$

$$\alpha = 0.05$$


Test 1
```{r}
my_gapminder <- gapminder::gapminder
my_t.test(my_gapminder$lifeExp, "less", 60)

```
# Elaboration

# Test 2

```{r}
my_t.test(my_gapminder$lifeExp, "greater", 60)

```
# Elaboration

# Test 3

```{r}
my_t.test(my_gapminder$lifeExp, "two.sided", 60)

```
# Elaboration

### my_lm

# Explanation

```{r}

my_model <- my_lm(lifeExp ~ gdpPercap * continent,
                my_gapminder[c("lifeExp", "gdpPercap", "continent")])
my_model
```

# Elaboration

```{r}
# change
lm_fit <- lm(lifeExp ~ gdpPercap * continent,
             my_gapminder[c("lifeExp", "gdpPercap", "continent")])
mod_fits <- fitted(lm_fit)
my_df <- data.frame(actual = my_gapminder$lifeExp, fitted = mod_fits)
ggplot(my_df, aes(x = fitted, y = actual)) +
  geom_point() +
  geom_abline(slope = 1, intercept = 0, col = "red", lty = 2) +
  theme_bw(base_size = 12) +
  labs(x = "Fitted values", y = "Actual values", title = "Actual vs. Fitted") +
  theme(plot.title = element_text(hjust = 0.5))
```

# Elaboration

### my_knn_cv

# This function ....
# Input ....
```{r}
# import my_penguins data
data(my_penguins)
# delete rows with NA data
penguins <- na.omit(my_penguins)
# create x and y matrices
train <- penguins[3:6]
cl <- penguins %>% pull(species)
# Initiate empty lists to store training and CV misclassfication rates
training_error = rep(NA, length(10))
cv_error = rep(NA, length(10))
# Iterate different fits from k_nn of 1 to 10
for (n in 1:10){
  results <- my_knn_cv(train, cl, n, 5)
  training_error[n] <- results$training_error
  cv_error[n] <- results$cv_error
}
# Organize the errors into a table
err_data <- data.frame("k_nn" = c(1:10),
                       "cv_error" = cv_error,
                       "training_error" = training_error)
kable_styling(kable(err_data))
```

### my_rf_cv

```{r}
data(my_penguins)
my_penguins <- my_penguins %>% drop_na()

# create a list to label the number of folds
folds <- c(rep("2", 30), rep("5", 30), rep("10", 30))
# create empty lists to store MSE
MSE_2 <- rep(NA, length(30))
MSE_5 <- rep(NA, length(30))
MSE_10 <- rep(NA, length(30))
# fill MSE data
for (k in 1:30){
  MSE_2[k] <- my_rf_cv(2)
  MSE_5[k] <- my_rf_cv(5)
  MSE_10[k] <- my_rf_cv(10)
}
# combine the label and data into one data frame
MSE_data <- data.frame(names = folds,
                       MSE = c(MSE_2, MSE_5, MSE_10))
```
```{r, fig.width=10,fig.height=11}
# plot the data
ggplot(data = MSE_data,
       aes(x = names, MSE)) +
  geom_boxplot(fill = "lightblue") +
  theme_bw(base_size = 20) +
  labs(title = "MSE According to Number of Folds",
       x = "Number of Folds",
       y = "MSE") +
  theme(plot.title =
          element_text(hjust = 0.5),
        text = element_text(size = 12))
```
```{r}
MSE_table <- data.frame("folds" = c(2, 5, 10),
                        "mean" = c(mean(MSE_2), mean(MSE_5), mean(MSE_10)),
                        "std_deviation" = c(sd(MSE_2), sd(MSE_5), sd(MSE_10)))
kable_styling(kable(MSE_table))
```



